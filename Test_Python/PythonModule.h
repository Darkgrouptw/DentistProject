#pragma once
#include <iostream>
#include <cassert>
#include <string>
#include <Python.h>

using namespace std;

#define SAVE_DELETE_PY(object) if(object != NULL) Py_DECREF(object);

class PythonModule
{
public:
	PythonModule(string);
	~PythonModule();

	//////////////////////////////////////////////////////////////////////////
	// 傳送 Function 會用到的
	//////////////////////////////////////////////////////////////////////////
	void SetArgs(int);
	void AddArgs(int, int);
	void AddArgs(double, int);

	//////////////////////////////////////////////////////////////////////////
	// Return 的部分 
	// 
	// 要注意事項:
	// 1. 這邊有一個問題，就是如果少傳參數會報錯
	//////////////////////////////////////////////////////////////////////////
	void CallFunction(string);
	int CallFunction_ReturnInt(string);

private:
	//////////////////////////////////////////////////////////////////////////
	// Python 連接的函數
	//////////////////////////////////////////////////////////////////////////
	void Init(const char*);
	void Close();
	PyObject* pyModule = NULL;
	PyObject* pyArgs = NULL;
	int ArgSize = -1;

	//////////////////////////////////////////////////////////////////////////
	// Helper Function
	//////////////////////////////////////////////////////////////////////////
	void GetPythonError(PyObject*);
};